<!DOCTYPE html>
<html>
    <head>
        <title>Vue 2.0 Product Curation - Curate Product</title>

        <style>
            #header {
                background-color:white;
                color:black;
                text-align:center;
                padding:4px;
                box-shadow: 2px 2px 2px 1px #aaaaaa;
            }
            #instructions {
                width: 500px;
                height: 80px;
                text-align:left;
                background-color: lightcyan;
                box-shadow: 1px 1px 1px #aaaaaa;
            }
            table.altrowstable {
                font-family: verdana, arial, sans-serif;
                color: #333333;
                border-width: 1px;
                border-color: #6B9FFF;
                border-collapse: collapse;
            }

            table.altrowstable th {
                font-size: 12px;
                border-width: 1px;
                padding: 8px;
                border-style: solid;
                border-color: #6B9FFF;
            }

            table.altrowstable td {
                border-width: 1px;
                font-size: 10px;
                padding: 8px;
                border-style: solid;
                border-color: #6B9FFF;
            }

            .oddrowcolor {
                background-color: #d4e3e5;
            }

            .evenrowcolor {
                background-color: #c3dde0;
            }

            .multiselect {
                width:20em;
                height:15em;
                border:solid 1px #c0c0c0;
                overflow:auto;
            }

            .multiselect label {
                display:block;
            }

            .multiselect-on {
                color:#ffffff;
                background-color:#000099;
            }

            p { display: inline-block; }

        </style>

        <style type="text/css">
            .form-style-7{
                max-width:660px;
                margin:50px auto;
                background:#fff;
                border-radius:2px;
                padding:20px;
                font-family: Georgia, "Times New Roman", Times, serif;
            }
            .form-style-7 h1{
                display: block;
                text-align: center;
                padding: 0;
                margin: 0px 0px 20px 0px;
                color: #5C5C5C;
                font-size:x-large;
            }
            .form-style-7 ul{
                list-style:none;
                padding:0;
                margin:0;
            }
            .form-style-7 li{
                display: block;
                padding: 9px;
                border:1px solid #DDDDDD;
                margin-bottom: 30px;
                border-radius: 3px;
            }
            .form-style-7 li:last-child{
                border:none;
                margin-bottom: 0px;
                text-align: center;
            }
            .form-style-7 li > label{
                display: block;
                float: left;
                margin-top: -19px;
                background: #FFFFFF;
                height: 14px;
                padding: 2px 5px 2px 5px;
                color: #B9B9B9;
                font-size: 14px;
                overflow: hidden;
                font-family: Arial, Helvetica, sans-serif;
            }
            .form-style-7 input[type="text"],
            .form-style-7 input[type="date"],
            .form-style-7 input[type="datetime"],
            .form-style-7 input[type="email"],
            .form-style-7 input[type="number"],
            .form-style-7 input[type="search"],
            .form-style-7 input[type="time"],
            .form-style-7 input[type="url"],
            .form-style-7 input[type="password"],
            .form-style-7 textarea,
            .form-style-7 select
            {
                box-sizing: border-box;
                -webkit-box-sizing: border-box;
                -moz-box-sizing: border-box;
                width: 100%;
                display: block;
                outline: none;
                border: none;
                height: 25px;
                line-height: 25px;
                font-size: 14px;
                padding: 0;
                font-family: Georgia, "Times New Roman", Times, serif;
            }
            .form-style-7 input[type="text"]:focus,
            .form-style-7 input[type="date"]:focus,
            .form-style-7 input[type="datetime"]:focus,
            .form-style-7 input[type="email"]:focus,
            .form-style-7 input[type="number"]:focus,
            .form-style-7 input[type="search"]:focus,
            .form-style-7 input[type="time"]:focus,
            .form-style-7 input[type="url"]:focus,
            .form-style-7 input[type="password"]:focus,
            .form-style-7 textarea:focus,
            .form-style-7 select:focus 
            {
            }
            .form-style-7 li > span{
                background: #F3F3F3;
                display: block;
                padding: 3px;
                margin: 0 -9px -9px -9px;
                text-align: center;
                color: #C0C0C0;
                font-family: Arial, Helvetica, sans-serif;
                font-size: 11px;
            }
            .form-style-7 textarea{
                height: 60px;
            }
            .form-style-7 input[type="submit"],
            .form-style-7 input[type="button"]{
                background: #2471FF;
                border: none;
                padding: 10px 20px 10px 20px;
                border-bottom: 3px solid #5994FF;
                border-radius: 3px;
                color: #D2E2FF;
            }
            .form-style-7 input[type="submit"]:hover,
            .form-style-7 input[type="button"]:hover{
                background: #6B9FFF;
                color:#fff;
            }
            .myButtonRED {
                -moz-box-shadow: inset 0px 39px 0px -24px #e67a73;
                -webkit-box-shadow: inset 0px 39px 0px -24px #e67a73;
                box-shadow: inset 0px 39px 0px -24px #e67a73;
                background-color: #e4685d;
                -moz-border-radius: 4px;
                -webkit-border-radius: 4px;
                border-radius: 4px;
                border: 1px solid #ffffff;
                display: inline-block;
                cursor: pointer;
                color: #ffffff;
                font-family: arial;
                font-size: 15px;
                padding: 6px 15px;
                text-decoration: none;
                text-shadow: 0px 1px 0px #b23e35;
            }
            tr td:hover
            {
                background-color: #DBE9FF;
            }
            .active
            {
                background-color: #7DAFFF;
            }
            /* to stretch the container div to contain floated list */
            #navcontainer:after
            {
                content: ".";
                display: block;
                line-height: 1px;
                font-size: 1px;
                clear: both;
            }

            ul#navlist
            {
                list-style: lower-roman;
                padding: 0;
                margin: 10 auto;
                width: 80%;
                font-size: medium;

            }

            ul#navlist li
            {
                display: block;
                float: left;
                width: auto;
                margin: 0;
                padding: 0;


            }

            ul#navlist li a
            {
                display: block;
                width: 100%;
                padding: 0.5em;
                border-width: 3px;
                border-color: #ffe #aaab9c #ccc #fff;
                border-style: solid;
                color: #000000;
                text-decoration-color:#f50fba;
                background: #f7f2ea;

            }

            #navcontainer>ul#navlist li a { width: auto; }

            ul#navlist li#active a
            {
                background: #f0e7d7;
                color: #800000;
                font-size: medium

            }

            ul#navlist li a:hover, ul#navlist li#active a:hover
            {
                color: #800000;
                background: transparent;
                border-color: #aaab9c #fff #fff #ccc;
            }



            .datagrid table { 

                text-align: center;
                width: 100%; 
            } .datagrid {
                font: normal 12px/150% Arial, Helvetica, sans-serif; background: #fff; overflow: hidden;
                border: 1px solid #006699; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; 
            }.datagrid table td, .datagrid table th {
                padding: 3px 10px; 

            }.datagrid table thead th {
                background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #006699), color-stop(1, #00557F) );
                background:-moz-linear-gradient( center top, #006699 5%, #00557F 100% );
                filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#006699', endColorstr='#00557F');
                background-color:#006699; color:#FFFFFF; font-size: 15px; font-weight: bold; border-left: 1px solid #0070A8;
            } .datagrid table thead th:first-child { border: none;
            }.datagrid table tbody td { 
                color: #00557F; border-left: 1px solid #E1EEF4;font-size: 14px;font-weight: normal;
            }.datagrid table tbody .alt td { background: #E1EEf4; color: #00557F; 
            }.datagrid table tbody td:first-child { border-left: none; }.datagrid table tbody tr:last-child td { 
                border-bottom: none; }
            </style>
            <script>
                var productTypeList, occasionList, productDescriptionList;
                var cacheLocalTags = [];
                var localTagsObject = {tagCategory: "", tagString: "", tagSubCategory: ""};
                var initialValues = {Title: "", Description: "", ProductTags: null, CurrentProductState: "", PrductProviders: null};
                var available_colors = ["Red", "Green", "Blue", "Cyan", "Orange", "Purple", "Black"];
                var available_sizes = ["No Size", "XS", "S", "M", "L", "XL", "XXL", "XXXL"];
                //prototype for clear the array values.
                Array.prototype.clear = function() {
                    this.length = 0;
                };
                var datafromparent;
                var jsonObject;
                var providerUpdaterequest;
                var tagCreateRequest;
                var tagCreationReqeustCount = 0;
                var productTagAssociateReq;
                var appendtagToProduct;
                var tagObject = {tagCategory: "", tagString: "", tagSubCategory: ""};
                var tagArray = [];
                var tags;
                var tagRequest;
                var tagsArray = [];
                var curatorId;
                //for tags validation.
                var localTags = [];
                var curatorReview;
                var buttonValue;
                var productTypeTagCount = 0;
                var occasionTagCount = 0;
                var productDescriptionTagCount = 0;

                var partialCurated = false;

                window.addEventListener("message", function(event) {

                    var strings = event.data.split("##");
                    tags = JSON.parse(strings[0]);
                    //for (var i = 0; i < tags.length; i++) {
                    // console.log(tags[i].tagString);
                    // }
                    datafromparent = strings[1]

                    curatorReview = strings[2];
                    cacheLocalTags.clear();
                    console.log(datafromparent);
                    console.log(datafromparent);
                    jsonObject = JSON.parse(datafromparent);
                    if (jsonObject.currentProductState == "CRAWLED") {
                        buttonValue = "Curate And Finish";
                        partialCurated = true;
                    } else {
                        partialCurated = false;
                        buttonValue = "Review And Finish";
                    }

                    tagCreationReqeustCount = 0;
                    tagArray.clear();
                    var isColorArrayNull = false;
                    var isAvailableSizes = false;
                    var isAvailableAtZipCodes = false;

                    if (jsonObject.productProviders !== null) {
                        for (var i = 0; i < jsonObject.productProviders.length; i++) {
                            if (jsonObject.productProviders[i].availableColors !== null && jsonObject.productProviders[i].availableColors !== undefined) {
                                if (jsonObject.productProviders[i].availableColors.length === 1) {

                                    if (jsonObject.productProviders[i].availableColors[0] == null || jsonObject.productProviders[i].availableColors[0] == "null") {
                                        isColorArrayNull = true;
                                        console.log("isColorArrayNull setTrue " + jsonObject.productProviders[i].availableColors[0]);
                                    }
                                }
                            } else {
                                console.log("NO productProviders.availableColors");
                            }
                            if (jsonObject.productProviders[i].availableSizes !== null && jsonObject.productProviders[i].availableSizes !== undefined) {

                                if (jsonObject.productProviders[i].availableSizes.length === 1) {

                                    if (jsonObject.productProviders[i].availableSizes[0] == null || jsonObject.productProviders[i].availableSizes[0] == "null") {
                                        isAvailableSizes = true;
                                        console.log("isAvailableSizes setTrue " + jsonObject.productProviders[i].availableColors[0]);
                                    }
                                }

                            } else {
                                console.log("NO productProviders.availableSizes");
                            }

                            if (jsonObject.productProviders[i].availableAtZipCodes !== null && jsonObject.productProviders[i].availableAtZipCodes !== undefined) {

                                if (jsonObject.productProviders[i].availableAtZipCodes.length === 1) {

                                    if (jsonObject.productProviders[i].availableAtZipCodes[0] == null || jsonObject.productProviders[i].availableAtZipCodes[0] == "null") {
                                        isAvailableAtZipCodes = true;
                                        console.log("isAvailableSizes setTrue " + jsonObject.productProviders[i].availableColors[0]);
                                    }
                                }
                            } else {
                                console.log("NO productProviders.availableAtZipCodes");
                            }
                        }

                    } else {
                        console.log("NO PRODUCT PROVIDERS");
                    }


                    var url = "https://vue-server-dev.appspot.com/api/productprovider/" + jsonObject.productProviders[0].id;
                    if (XMLHttpRequest) {
                        providerUpdaterequest = new XMLHttpRequest();
                        if ("withCredentials" in providerUpdaterequest) {
                            // Firefox 3.5 and Safari 4
                            providerUpdaterequest.open('PUT', url, true);
                            providerUpdaterequest.setRequestHeader('Custom-Header', 'javascript-client');
                            providerUpdaterequest.setRequestHeader('Content-Type', 'application/json');
                            providerUpdaterequest.onreadystatechange = function providerHandler() {
                                if (providerUpdaterequest.readyState != 4)
                                    return;

                                if (providerUpdaterequest.status != 200 && providerUpdaterequest.status != 304) {

                                    console.log("provder updated failed");
                                    return;
                                }
                                if (providerUpdaterequest.status == 200)
                                {

                                    console.log("provder updated successfully&&& " + providerUpdaterequest.responseText);

                                }

                            };

                            console.log("provider color fields " + isColorArrayNull);
                            console.log("provider isAvailableSizes field " + isAvailableSizes);
                            console.log("provider isAvailableAtZipCodes field " + isAvailableAtZipCodes);
                            if (isAvailableAtZipCodes) {
                                jsonObject.productProviders[0].availableAtZipCodes = null;
                                console.log("provider availableAtZipCodes fields 1");
                            }
                            if (isColorArrayNull) {
                                jsonObject.productProviders[0].availableColors = null;
                                console.log("provider availableColors fields 2");
                            }
                            if (isAvailableSizes) {
                                jsonObject.productProviders[0].availableSizes = null;
                                console.log("provider availableSizes fields 3 ");
                            }

                            if (isAvailableAtZipCodes || isColorArrayNull || isAvailableSizes) {
                                providerUpdaterequest.send(JSON.stringify({id: jsonObject.productProviders[0].id, ownerProductId: jsonObject.id, externalURL: jsonObject.productProviders[0].externalURL, quantity: jsonObject.productProviders[0].quantity, currencyCode: jsonObject.productProviders[0].currencyCode, store: jsonObject.productProviders[0].store, availability: jsonObject.productProviders[0].availability,
                                    price: jsonObject.productProviders[0].price, onSale: jsonObject.productProviders[0].onSale, salePrice: jsonObject.productProviders[0].salePrice, saleExpirtyDate: 0, availableColors: jsonObject.productProviders[0].availableColors, availableSizes: jsonObject.productProviders[0].availableSizes, availableAtZipCodes: jsonObject.productProviders[0].availableAtZipCodes}));
                            }
                        }
                    }


                    afterLoadingThePopup();
                }, false);

                function dataloader() {
                    var val = document.getElementById('divid');
                    val.innerHTML = datafromparent;
                    console.log(datafromparent);
                }
                function afterLoadingThePopup() {
                    var jsonResponse = JSON.parse(datafromparent);
                    document.getElementById('id_title').value = jsonResponse.title;
                    document.getElementById('id_description').value = "";
                    //method to call to set current product state...
                    set_current_ProductState(jsonResponse.currentProductState);
                    // document.getElementById('single_select_1').value = jsonResponse.currentProductState;



                    document.getElementById('currency_id').value = jsonObject.productProviders[0].currencyCode;
                    document.getElementById('price_id').value = jsonObject.productProviders[0].price;
                    document.getElementById('store_id').value = jsonObject.productProviders[0].store;
                    var offerEnable = jsonObject.productProviders[0].onSale;
                    var saleExpiryDate = document.getElementById('expiry_date_id');
                    var salePrice = document.getElementById('sale_price_id');
                    saleExpiryDate.value = jsonObject.productProviders[0].saleExpirtyDate;
                    salePrice.value = jsonObject.productProviders[0].salePrice;
                    if (offerEnable) {
                        document.getElementById('onSale_selection_id').checked = true;
                    } else {
                        document.getElementById('onSale_selection_id').checked = false;
                        salePrice.style.backgroundColor = "gray";
                        saleExpiryDate.style.backgroundColor = "gray";


                        salePrice.readOnly = "true";
                        saleExpiryDate.readOnly = "true";
                        salePrice.value = "No Offers";
                        saleExpiryDate.value = "No Offers";
                    }
                    document.getElementById('color_id').value = jsonObject.productProviders[0].availableColors;
                    document.getElementById('size_id').value = jsonObject.productProviders[0].availableSizes;
                    // product tags..
                    var product_tags = jsonResponse.productTags;
                    for (var m = 0; m < product_tags.length; m++) {
                        var tag_obj = product_tags[m];

                        if (tag_obj === null || tag_obj === undefined) {
                            continue;
                        }

                        var tag_cat = tag_obj.tagCategory;
                        var tag_string = tag_obj.tagString;
                        var tag_sub_cat = tag_obj.tagSubCategory;


                        if (tag_cat.toLowerCase() === "Product Description".toLowerCase()) {
                            productDescriptionTagCount = productDescriptionTagCount + 1;
                        } else if (tag_cat.toLowerCase() === "Product Type".toLowerCase()) {
                            productTypeTagCount = productTypeTagCount + 1;
                        } else if (tag_cat.toLowerCase() === "Occasion".toLowerCase()) {
                            occasionTagCount = occasionTagCount + 1;
                        }
                        cacheLocalTags.push(tag_string);
                        createTagReqAndAddTable(tag_cat, tag_string, tag_sub_cat, 0)

                    }
                    //Added Product Tags
                    //  add_Product_Tags();
                    add_Product_TagsNew();
                    excuteOccasion();
                }

                function addTagsToTable(type) {
                    var table = document.getElementById('tablewithtags_id');
                    table.innerHTML = '';
                    var tbdy = document.createElement('tbody');
                    if (type === 0) {
                        var tr = document.createElement('tr');
                        for (var i = 0; i < productTypeList.length; i++) {
                            if (i > 100) {
                                continue;
                            }
                            var cells = tr.getElementsByTagName('td');
                            var cellCount = cells.length;
                            //alert(cellCount);
                            if (cellCount <= 4) {
                                var td = document.createElement('td');
                                td.textContent = productTypeList[i];
                                td.id = "nottoadd";
                                tr.appendChild(td);
                            } else {
                                tbdy.appendChild(tr);
                                tr == null;
                                tr = document.createElement('tr');
                            }

                        }

                        tbdy.appendChild(tr);
                        table.appendChild(tbdy);
                    } else if (type === 1) {
                        var tr = document.createElement('tr');
                        for (var i = 0; i < occasionList.length; i++) {
                            if (i > 100) {
                                continue;
                            }

                            var cells = tr.getElementsByTagName('td');
                            var cellCount = cells.length;
                            //alert(cellCount);
                            if (cellCount <= 4) {
                                var td = document.createElement('td');
                                td.textContent = occasionList[i];
                                td.id = "nottoadd";
                                tr.appendChild(td);
                            } else {
                                tbdy.appendChild(tr);
                                tr == null;
                                tr = document.createElement('tr');
                            }

                        }

                        tbdy.appendChild(tr);
                        table.appendChild(tbdy);
                    } else if (type === 2) {
                        var tr = document.createElement('tr');
                        for (var i = 0; i < productDescriptionList.length; i++) {
                            if (i > 100) {
                                continue;
                            }

                            var cells = tr.getElementsByTagName('td');
                            var cellCount = cells.length;
                            //alert(cellCount);
                            if (cellCount <= 4) {
                                var td = document.createElement('td');
                                td.textContent = productDescriptionList[i];
                                td.id = "nottoadd";
                                tr.appendChild(td);
                            } else {
                                tbdy.appendChild(tr);
                                tr == null;
                                tr = document.createElement('tr');
                            }
                        }
                        tbdy.appendChild(tr);
                        table.appendChild(tbdy);
                    }
                    setCallTagsTable();
                }



                function add_Product_TagsNew() {

                    var static_categoryNames = ["Product Type", "Occasion", "Product description"]
                    //add provider tags
                    var tag_category_array = new Array();
                    var tag_string_array = new Array();
                    var tag_category_array_uniqueNames = [];
                    var tag_string_array_uniqueNames = [];
                    var tag_substring_array_uniqueNames = [];
                    for (var k = 0; k < tags.length; k++) {
                        var vcat = tags[k].tagCategory;
                        var vstr = tags[k].tagString;
                        if (vcat !== null && vcat !== undefined && vcat !== '') {
                            tag_category_array = tag_category_array.concat(vcat.split(','));
                            var list_tagstring_array = tag_string_array[vcat];
                            if (vstr !== null && vstr !== undefined && vstr !== '') {

                                if (list_tagstring_array !== undefined) {
                                    list_tagstring_array.push(vstr);
                                } else {
                                    list_tagstring_array = new Array();
                                    list_tagstring_array.push(vstr);
                                }

                            }
                            // alert('ffffffirst:' + list_tagstring_array + "VVV:" + vcat);
                            tag_string_array[vcat] = list_tagstring_array;
                        }



                    }


                    $.each(tag_category_array, function(i, el) {
                        if ($.inArray(el, tag_category_array_uniqueNames) === -1)
                            tag_category_array_uniqueNames.push(el);
                    });
                    for (k = 0; k < static_categoryNames.length; k++) {
                        if (k === 0) {
                            // var tagcatelement = document.getElementById('select_tagCategory');
                            var temp0 = tag_string_array[static_categoryNames[k]];
                            productTypeList = temp0;
                            // tagcatelement.options[tagcatelement.options.length] = new Option('', '', false, false);

                        }
                        if (k === 1) {

                            var temp1 = tag_string_array[static_categoryNames[k]];
                            occasionList = temp1;
                        }
                        if (k === 2) {

                            var temp2 = tag_string_array[static_categoryNames[k]];
                            productDescriptionList = temp2;
                        }
                    }

                    //set default values from backend
                    $("select").multiselect({
                        selectedList: 4}).multiselectfilter();
                }



                function  set_current_ProductState(value) {

                    var product_state_sel = document.getElementById('single_select_1');
                    if (jsonObject.currentProductState === 'CRAWLED') {
                        var enums = ['CURATED'];
                    } else {
                        var enums = ['CURATED_AND_VERIFIED', 'NEEDS_RECURATION'];
                    }
                    // var enums = ['CRAWLED', 'CURATED', 'CURATED_AND_VERIFIED', 'NEEDS_RECURATION'];
                    var td = document.createElement('td');
                    var name = "current_product_status";

                    for (var i = 0; i < enums.length; i++) {

                        if ('CRAWLED' === value) {
                            // alert('curated22: '+value);
                            var v = getRadioButton(name, enums[i], true);
                            td.appendChild(v);

                        } else {
                            var stateVal = false;
                            if (i === 0) {
                                stateVal = true;
                            } else {
                                stateVal = false;
                            }
                            var v = getRadioButton(name, enums[i], stateVal);
                            td.appendChild(v)
                        }

                    }

                    product_state_sel.appendChild(td);

                }

                function getRadioButton(name, text, status) {

                    var label = document.createElement('label');
                    label.textContent = text;

                    var input = document.createElement('input');
                    input.type = 'radio';
                    input.name = name;
                    input.value = text;
                    input.textContent = text;
                    input.checked = status;
                    label.appendChild(input);


                    label.appendChild(input);

                    return label;
                }

                function getCuratedInfo() {
                    var title = document.getElementById("id_title").value;
                    var description = document.getElementById("id_description").value;
                    var checkedVal = document.querySelector('input[name="current_product_status"]:checked');
                    description = description.trim();
                    title = title.trim();

                    var titleNode = document.getElementById('title_node_id');
                    if (checkedVal === null) {

                        alert("Please Check ProductState");
                        return false;
                    }


                    if (title === undefined || title === " " || title.length < 2) {
                        document.getElementById('title_node_id').scrollIntoView();
                        titleNode.innerHTML = "*Please Fill Descripiton";
                        titleNode.style.color = "#ff0000";
                        showAlert("Please fill the title");
                        return false;
                    } else {
                        titleNode.innerHTML = " ";
                        titleNode.style.color = "#ff0000";
                    }
                    jsonObject.title = title;

                    var discripitonNode = document.getElementById('description_node_id');

                    if (description === undefined || description === " " || description.length < 2) {
                        discripitonNode.innerHTML = "*Please Fill Descripiton";
                        discripitonNode.style.color = "#ff0000";
                        document.getElementById('description_node_id').scrollIntoView();
                        document.getElementById('id_description').focus();
                        //showAlert("Please fill the description");
                        return false;
                    } else {
                        discripitonNode.innerHTML = " ";
                        discripitonNode.style.color = "#ff0000";
                    }

                    if (!description.match(/[a-z]/i)) {
                        //showAlert("Description contains only Numbers");
                        discripitonNode.innerHTML = "*Description contains only Numbers";
                        discripitonNode.style.color = "#ff0000";
                        document.getElementById('description_node_id').scrollIntoView();
                        return false;
                    }
                    if (!title.match(/[a-z]/i)) {
                        //showAlert("Title contains only Numbers");
                        document.getElementById('title_node_id').scrollIntoView();
                        titleNode.innerHTML = "*Title contains only Numbers";
                        titleNode.style.color = "#ff0000";
                        return false;
                    }

                    jsonObject.description = description;


                    if (localTags.length < 3 && !partialCurated) {
                        showAlert("Error: Please create minimum 3 Tags.");
                        return false;
                    }

                    if (productTypeTagCount < 1) {
                        showAlert("Error: Please create atleast one ProductType Tag.");
                        return false;
                    }
                    if (occasionTagCount < 1) {
                        showAlert("Error: Please create atleast one Occasion Tag.");
                        return false;
                    }

                    if (productDescriptionTagCount < 1 && !partialCurated) {
                        showAlert("Error: Please create atleast one Product Description Tag.");
                        return false;
                    }



                    return true;

                }
                function showAlert(message) {
                    alert(message);
                }
                function curateProduct() {
                    if (!getCuratedInfo()) {
                        return;
                    }
                    var title = document.getElementById("id_title").value;
                    var description = document.getElementById("id_description").value;
                    jsonObject.currentProductState = document.querySelector('input[name="current_product_status"]:checked').value;
                    var url = "https://vue-server-dev.appspot.com/api/product/" + jsonObject.id;
                    if (XMLHttpRequest) {
                        request = new XMLHttpRequest();
                        if ("withCredentials" in request) {
                            // Firefox 3.5 and Safari 4
                            request.open('PUT', url, true);
                            request.setRequestHeader('Custom-Header', 'javascript-client');
                            request.setRequestHeader('Content-Type', 'application/json');
                            request.onreadystatechange = update_handler;
                            //product update request:
                            request.send(JSON.stringify({id: jsonObject.id, ownerAisleId: jsonObject.ownerAisleId, ownerProductListId: jsonObject.ownerProductListId, creatorId: jsonObject.creatorId, curatorId: jsonObject.curatorId, title: title, description: description, currentProductState: jsonObject.currentProductState, relatedProductIds: null, productTags: null, productImages: null, productProviders: null, comments: null, ratings: null}));
                        }
                    }

                }

                function update_handler() {
                    if (request.readyState != 4)
                        return;
                    if (request.status == 200)
                    {
                        //updateProvider();
                        if (curatorReview == "Curate Now") {
                            alert('Info: Curated Successfully : ' + request.responseText);
                        } else {
                            alert('Info: Reviewed Successfully :' + request.responseText);
                        }

                        //window.opener.close();
                        //close();
                    }
                    if (request.status != 200 && request.status != 304) {
                        //alert('HTTP POST error ' + request.status + 'Response ' + request.responseText);
                        return;
                    }
                }
                function getCuratedArray(myarra) {

                    var curatedArray = [];
                    for (var i = 0; i < myarra.length; i++) {
                        var item = myarra[i];
                        if (item !== null) {
                            item = item.trim();
                            if (item.length === 0 || item === "null") {

                            } else {
                                curatedArray.push(item);
                            }
                        }
                    }
                    if (curatedArray.length == 0) {
                        curatedArray = null;
                    }
                    return curatedArray;
                }
                function updateProvider() {
                    var provider_node_text = document.getElementById('provider_node_id');
                    var colorWarningText = document.getElementById('color_node_id');
                    var sizeWarningText = document.getElementById('size_node_id');

                    colorWarningText.innerHTML = "";
                    provider_node_text.innerHTML = "";
                    sizeWarningText.innerHTML = "";

                    //get colors
                    var colors = document.getElementById('color_id').value;
                    colors = toTitleCase(colors);
                    var colorArray = colors.split(",");
                    colorArray = getCuratedArray(colorArray);

                    //get Sizes
                    var sizes = document.getElementById('size_id').value;
                    sizes = toTitleCase(sizes);
                    var sizesArray = sizes.split(",");
                    sizesArray = getCuratedArray(sizesArray);

                    //get offer price
                    var onSaleValue = document.getElementById('onSale_selection_id').checked;
                    var saleExpiryDate = 0;
                    var salePrice = 0
                    if (onSaleValue) {
                        saleExpiryDate = document.getElementById('expiry_date_id').value;
                        salePrice = document.getElementById('sale_price_id').value;
                        if (salePrice === undefined || salePrice === null || salePrice.length < 1 || salePrice === 0) {
                            provider_node_text.innerHTML = "*Please Fill Offer Price";
                            provider_node_text.style.color = "#ff0000";
                            document.getElementById('provider_node_id').scrollIntoView();
                            // alert("Please Fill salePrice");
                            return;
                        }
                        provider_node_text.innerHTML = "";
                        salePrice = salePrice.trim();
                        salePrice = parseFloat(salePrice.replace(',', ''));
                        if (saleExpiryDate === undefined || saleExpiryDate === null || saleExpiryDate.length < 1 || saleExpiryDate === 0) {
                            saleExpiryDate = 0;
                        }

                    } else {

                    }

                    //get currency
                    var currency = document.getElementById('currency_id').value;

                    //get price
                    var price = document.getElementById('price_id').value;

                    //get store
                    var store = document.getElementById('store_id').value;



                    store = store.trim();
                    price = price.trim();

                    price = parseFloat(price.replace(',', ''));


                    var availability = document.querySelector('input[name="group1"]:checked').value;



                    if (currency === undefined || currency === null || currency.length < 1 || currency === 0) {

                        provider_node_text.innerHTML = "*Please Fill Currency";
                        provider_node_text.style.color = "#ff0000";
                        document.getElementById('currency_id').scrollIntoView();
                        // alert("Please Fill Currency");
                        return;
                    }

                    if (price === undefined || price === null || price.length < 1 || price === 0 || isNaN(price)) {
                        provider_node_text.innerHTML = "*Please Fill Price";
                        provider_node_text.style.color = "#ff0000";
                        document.getElementById('currency_id').scrollIntoView();
                        //alert("Please Fill Price");
                        return;
                    }
                    if (store === undefined || store === null || store.length < 1 || store === 0) {
                        provider_node_text.innerHTML = "*Please Fill Store";
                        provider_node_text.style.color = "#ff0000";
                        document.getElementById('currency_id').scrollIntoView();
                        // alert("Please Fill Store");
                        return;
                    }
                    provider_node_text.innerHTML = "";
                    provider_node_text.style.color = "#ff0000";
                    if (colorArray === undefined || colorArray === null || colorArray.length < 1) {
                        if (!partialCurated) {
                            // alert("Please Fill Available Colors");
                            document.getElementById('color_node_id').scrollIntoView();

                            colorWarningText.innerHTML = "*Please file the Colors";
                            colorWarningText.style.color = "#ff0000";
                            return;
                        }
                    } else {

                        colorWarningText.innerHTML = "";
                    }

                    if (sizesArray === undefined || sizesArray === null || sizesArray.length < 1) {



                        if (!partialCurated) {
                            document.getElementById('size_node_id').scrollIntoView();
                            // alert("Please Fill Available Sizes");
                            sizeWarningText.innerHTML = "*Please file the Sizes";
                            sizeWarningText.style.color = "#ff0000";
                            return;
                        }
                    } else {

                        sizeWarningText.innerHTML = "";
                    }


                    var url = "https://vue-server-dev.appspot.com/api/productprovider/" + jsonObject.productProviders[0].id;
                    if (XMLHttpRequest) {
                        providerUpdaterequest = new XMLHttpRequest();
                        if ("withCredentials" in providerUpdaterequest) {
                            // Firefox 3.5 and Safari 4
                            providerUpdaterequest.open('PUT', url, true);
                            providerUpdaterequest.setRequestHeader('Custom-Header', 'javascript-client');
                            providerUpdaterequest.setRequestHeader('Content-Type', 'application/json');
                            providerUpdaterequest.onreadystatechange = function providerHandler() {
                                if (providerUpdaterequest.readyState != 4)
                                    return;

                                if (providerUpdaterequest.status != 200 && providerUpdaterequest.status != 304) {

                                    alert('HTTP POST error ' + providerUpdaterequest.status + 'Response ' + providerUpdaterequest.responseText);
                                    return;
                                }
                                if (providerUpdaterequest.status == 200)
                                {

                                    curateProduct();

                                }

                            };
                            providerUpdaterequest.send(JSON.stringify({id: jsonObject.productProviders[0].id, ownerProductId: jsonObject.id, externalURL: jsonObject.productProviders[0].externalURL, quantity: jsonObject.productProviders[0].quantity, currencyCode: currency, store: store, availability: availability,
                                price: price, onSale: onSaleValue, salePrice: salePrice, saleExpirtyDate: 0, availableColors: colorArray, availableSizes: sizesArray, availableAtZipCodes: null}));
                            //print logs in console        
                            console.log("Provider: " + JSON.stringify({id: jsonObject.productProviders[0].id, ownerProductId: jsonObject.id, externalURL: jsonObject.productProviders[0].externalURL, quantity: jsonObject.productProviders[0].quantity, currencyCode: currency, store: store, availability: availability,
                                price: price, onSale: onSaleValue, salePrice: salePrice, saleExpirtyDate: saleExpiryDate, availableColors: colorArray, availableSizes: sizesArray, availableAtZipCodes: null}));
                        }
                    }
                }


                function createTagRequest(category, string, subcat) {
                    console.log("createTagRequest fun:   CAT:" + category + " Tag String: " + string);
                    if (category.toLowerCase() == "Product Type".toLowerCase()) {
                        productTypeTagCount = productTypeTagCount + 1;
                    } else if (category.toLowerCase() == "Occasion".toLowerCase()) {
                        occasionTagCount = occasionTagCount + 1;
                    } else if (category.toLowerCase() == "Product description".toLowerCase()) {
                        productDescriptionTagCount = productDescriptionTagCount + 1;
                    }

                    var url = "https://vue-server-dev.appspot.com/api/producttag";
                    if (XMLHttpRequest) {
                        tagCreateRequest = new XMLHttpRequest();
                        if ("withCredentials" in tagCreateRequest) {
                            tagCreateRequest.open('POST', url, true);
                            tagCreateRequest.setRequestHeader('Custom-Header', 'javascript-client');
                            tagCreateRequest.setRequestHeader('Content-Type', 'application/json');
                            tagCreateRequest.onreadystatechange = tagHandler;
                            tagCreateRequest.send(JSON.stringify({tagCategory: category, tagString: string, tagSubCategory: subcat}));
                        }
                    }
                }
                function tagHandler() {
                    if (tagCreateRequest.readyState != 4)
                        return;
                    if (tagCreateRequest.status != 200 && tagCreateRequest.status != 304) {
                        //ToDO: if tag is created already just append to product.  appendtagToProduct  
                        if (appendtagToProduct != undefined) {
                            tagAssociateWithProduct(appendtagToProduct, "tag");
                        }
                        return;
                    }
                    if (tagCreateRequest.status == 200)
                    {
                        console.log("createTagRequest fun success:    ");
                        var jsonTagObject = JSON.parse(tagCreateRequest.responseText);
                        tagAssociateWithProduct(jsonTagObject.tagString, "tag");
                    }

                }
                var taging;
                function tagAssociateWithProduct(tagString, tag) {
                    console.log("tagAssociateWithProduct fun success:    TAGString: " + tagString);
                    taging = tag;
                    if (tag == "untag") {
                        var position = localTags.indexOf(tagString);
                        if (position != -1) {
                            localTags.splice(position, 1);
                        }
                    }
                    var url = "https://vue-server-dev.appspot.com/api/product/" + tag + "/" + jsonObject.id + "/" + tagString;
                    if (XMLHttpRequest) {
                        productTagAssociateReq = new XMLHttpRequest();
                        if ("withCredentials" in productTagAssociateReq) {
                            // Firefox 3.5 and Safari 4
                            productTagAssociateReq.open('PUT', url, true);
                            productTagAssociateReq.setRequestHeader('Custom-Header', 'javascript-client');
                            productTagAssociateReq.setRequestHeader('Content-Type', 'application/json');
                            productTagAssociateReq.onreadystatechange = tagAssociatHandler;
                            productTagAssociateReq.send();
                        }
                    }

                }

                function tagAssociatHandler() {
                    if (productTagAssociateReq.readyState != 4)
                        return;
                    if (productTagAssociateReq.status != 200 && productTagAssociateReq.status != 304) {
                        alert('HTTP POST error ' + productTagAssociateReq.status + 'Response ' + productTagAssociateReq.responseText);
                        return;
                    }
                    if (productTagAssociateReq.status == 200)
                    {
                        console.log("tagAssociatHandler fun success response:    " + productTagAssociateReq.responseText);
                        console.log("tagAssociateWithProduct fun success:      ");

                    }

                }


                var taggingStarted = false;
                function tagToProduct() {
                    taggingStarted = true;
                    var tagString = tagsArray.splice(0, 1);
                    if (tagString === undefined || tagString.length < 1) {
                        taggingStarted = false;
                        return;
                    }

                    var url = "https://vue-server-dev.appspot.com/api/product/tag/" + jsonObject.id + "/" + tagString;
                    if (XMLHttpRequest) {
                        tagRequest = new XMLHttpRequest();
                        if ("withCredentials" in tagRequest) {
                            // Firefox 3.5 and Safari 4
                            tagRequest.open('PUT', url, true);
                            tagRequest.setRequestHeader('Custom-Header', 'javascript-client');
                            tagRequest.setRequestHeader('Content-Type', 'application/json');
                            tagRequest.onreadystatechange = tagToProductHandler;
                            tagRequest.send();
                        }
                    }

                }

                function tagToProductHandler() {
                    if (tagRequest.readyState !== 4)
                        return;
                    if (tagRequest.status !== 200 && tagRequest.status !== 304) {
                        // alert('HTTP POST error ' + tagRequest.status + 'Response ' + tagRequest.responseText);
                        tagToProduct();
                        return;
                    }
                    if (tagRequest.status === 200)
                    {
                        if (tagsArray.length == 0) {
                            // alert("Tags are attached to product");
                        }
                        tagToProduct();
                    }

                }
                function handleOnSAleClick(cb) {
                    var saleExpiryDate = document.getElementById('expiry_date_id');
                    var salePrice = document.getElementById('sale_price_id');
                    if (cb.checked) {
                        salePrice.style.backgroundColor = "white";
                        saleExpiryDate.style.backgroundColor = "white";
                        salePrice.readOnly = "false";
                        saleExpiryDate.readOnly = "false";
                        salePrice.removeAttribute("readonly");
                        saleExpiryDate.removeAttribute("readonly");
                        salePrice.value = "";
                        saleExpiryDate.value = "";
                        saleExpiryDate.placeholder = "Please Enter Valid Date";
                        salePrice.placeholder = "Please Enter Sale Price";
                    } else {
                        salePrice.style.backgroundColor = "gray";
                        saleExpiryDate.style.backgroundColor = "gray";
                        salePrice.readOnly = "true";
                        saleExpiryDate.readOnly = "true";
                        salePrice.value = "No Offers";
                        saleExpiryDate.value = "No Offers";
                    }
                }
            </script>

            <link rel="stylesheet" type="text/css" href="src/jquery.multiselect.css" />
            <link rel="stylesheet" type="text/css" href="src/jquery.multiselect.filter.css" />
            <link rel="stylesheet" type="text/css" href="assets/style.css" />
            <link rel="stylesheet" type="text/css" href="assets/prettify.css" />
            <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/ui-lightness/jquery-ui.css" />
            <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
            <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
            <script type="text/javascript" src="src/jquery.multiselect.js"></script>
            <script type="text/javascript" src="src/jquery.multiselect.filter.js"></script>
            <script type="text/javascript" src="assets/prettify.js"></script>


            <link rel="stylesheet" href="radio/style.css"/>
            <style type="text/css">
            label {margin-right:20px;}
        </style>
        <script type="text/javascript" src="radio/jspatch.js"></script>

        <script type="text/javascript">

                function addTagsToTableVaz() {

                    var tagtype;
                    $("a[name^='ok']").each(function() {
                        tagtype = this.textContent;
                    });
                    var elements = [];
                    $("td[id^='toadd']").each(function() {
                        var val = this.textContent;
                        elements.push(val);
                        if (val != undefined && this.textContent != '' && this.textContent != null) {
                            //  tagsArray.push(val);
                            //  addElementToTable(tagtype, val, '');
                        }

                    });
                    var stringOfTagss = elements.toString();
                    //for Occasion
                    if (tagtype !== null && tagtype !== undefined && tagtype !== '') {
                        var productType = tagtype;
                        for (var p = 0; p < elements.length; p++) {


                            for (var q = 0; q < tags.length; q++) {

                                var cat = tags[q].tagCategory;
                                var tagstr = tags[q].tagString;
                                var tagSubStr = tags[q].tagSubCategory;
                                if (cat !== null && cat !== undefined && cat.indexOf(tagtype) === 0 && tagstr.indexOf(elements[p]) === 0) {
                                    var index = cacheLocalTags.indexOf(tagstr);
                                    if (index == -1) {
                                        cacheLocalTags.push(tagstr);
                                        if (tagtype === 'Occasion')
                                            occasionTagCount = occasionTagCount + 1;
                                        if (tagtype === 'Product Type')
                                            productTypeTagCount = productTypeTagCount + 1;
                                        if (tagtype === 'Product description')
                                            productDescriptionTagCount = productDescriptionTagCount + 1;
                                        addElementToTable(tagtype, tagstr, tagSubStr);
                                        tagsArray.push(tagstr);
                                    } else {
                                        //alert("duplicate tag");
                                    }

                                }
                            }

                        }
                    }


//                    alert("Type: " + tagtype + " List:" + stringOfElementIDs);

                    //create TAG.
                    //   createTagRequest(valC, tagString, subCatString);
                    if (taggingStarted == false) {
                        tagToProduct();
                    } else {

                    }

                }

                function addElementToTable(cat, str, substr) {

                    createTagReqAndAddTable(cat, str, substr, 0);

                }

                function createCustomTag() {
                    var valC, valS, valSC;
                    valC = document.getElementById("id_tag_cat").value;
                    valS = document.getElementById("id_tag_str").value;
                    valSC = document.getElementById("id_sub_str").value;
                    if (valS === null || valS.length < 1 || valS === undefined) {
                        alert("Tag String must not empty");
                        return;
                    }
                    if (valC === null || valC.length < 1 || valC === undefined) {
                        alert("Tag Category must not empty");
                        return;
                    }
                    var index = cacheLocalTags.indexOf(valS);
                    if (index === -1) {
                        cacheLocalTags.push(valS);
                        document.getElementById("id_tag_str").value = "";
                        document.getElementById("id_tag_cat").value = '';
                        console.log("CAT:" + valC + " Tag String: " + valS);
                        valS = valS.trim();
                        valS = toTitleCase(valS);
                        createTagReqAndAddTable(valC, valS, valSC, 1);
                    } else {
                        alert("duplicate tag");
                    }

                }
                function toTitleCase(str)
                {
                    //make every starting letter capital.
                    return str.replace(/\w\S*/g, function(txt) {
                        return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                    });
                }
                function createTagReqAndAddTable(valC, valS, valSC, addtableonly) {
                    var row = document.createElement('tr');
                    var thC = document.createElement('th');
                    thC.textContent = valC;
                    var thS = document.createElement('th');
                    thS.textContent = valS;
                    var thSC = document.createElement('th');
                    thSC.textContent = valSC;
                    var del = document.createElement('th')
                    var btn = document.createElement('Button');
                    btn.textContent = 'Untag';
                    btn.onclick = function() {
                        document.getElementById('created_tags_table').removeChild(row);
                        var index = cacheLocalTags.indexOf(valS);
                        if (index !== -1) {
                            var removedTag = cacheLocalTags.splice(index, 1);


                        }
                        tagAssociateWithProduct(valS, "untag");

                        if (valC.toLowerCase() == "Product Type".toLowerCase()) {
                            productTypeTagCount = productTypeTagCount - 1;
                        } else if (valC.toLowerCase() == "Occasion".toLowerCase()) {
                            occasionTagCount = occasionTagCount - 1;
                        } else if (valC.toLowerCase() == "Product Description".toLowerCase()) {
                            productDescriptionTagCount = productDescriptionTagCount - 1;
                        }
                    };
                    del.appendChild(btn);
                    row.appendChild(thC);
                    row.appendChild(thS);
                    row.appendChild(thSC);
                    row.appendChild(del);
                    document.getElementById('created_tags_table').appendChild(row);

                    appendtagToProduct = valS;

                    if (valSC === undefined)
                        valSC === null;

                    //to attach local data

                    localTags.push(valS);
                    if (addtableonly === 1)
                        createTagRequest(valC, valS, valSC)
                }


                function  createGenderTag() {

                    var vl = document.querySelector('input[name="gender"]:checked').value;
                    var index = cacheLocalTags.indexOf(vl);
                    if (index == -1) {
                        tagsArray.push(vl);
                        cacheLocalTags.push(vl);
                        createTagReqAndAddTable('Product Description', vl, '', 0);
                        productDescriptionTagCount = productDescriptionTagCount + 1;
                        if (taggingStarted == false) {
                            tagToProduct();
                        } else {

                        }
                    } else {
                        alert("Warning: Duplicate tag");
                    }
                }
                function archieveProduct() {

                    var r = confirm("Do you want to Archive Product?");
                    if (r === true) {

                        var url = "https://vue-server-dev.appspot.com/api/product/" + jsonObject.id;
                        if (XMLHttpRequest) {
                            request = new XMLHttpRequest();
                            if ("withCredentials" in request) {
                                // Firefox 3.5 and Safari 4
                                request.open('PUT', url, true);
                                request.setRequestHeader('Custom-Header', 'javascript-client');
                                request.setRequestHeader('Content-Type', 'application/json');
                                request.onreadystatechange = function() {

                                    if (request.readyState !== 4)
                                        return;
                                    if (request.status !== 200 && request.status !== 304) {
                                        // alert('HTTP POST error ' + tagRequest.status + 'Response ' + tagRequest.responseText);

                                        return;
                                    }
                                    if (request.status === 200)
                                    {
                                        window.opener.close();
                                        close();

                                    }
                                };
                                //product update request:
                                request.send(JSON.stringify({id: jsonObject.id, ownerAisleId: jsonObject.ownerAisleId, ownerProductListId: jsonObject.ownerProductListId, creatorId: jsonObject.creatorId, curatorId: jsonObject.curatorId, title: jsonObject.title, description: jsonObject.description, currentProductState: "ARCHIVED", relatedProductIds: null, productTags: null, productImages: null, productProviders: null, comments: null, ratings: null}));
                            }
                        }
                    } else {

                    }
                }


                function setCallTagsTable() {
                    $("#tablewithtags_id td").click(function() {
                        rowClick(this);
                    });
                    $("#selecting_size_table td").click(function() {
                        //   alert(this.textContent)
                        clickedValue(this);
                    });
                }

                function  excuteOccasion() {
                    var eleoccasion = document.getElementById('occasion_id');
                    eleoccasion.style.backgroundColor = "#e59b7f";
                    eleoccasion.name = "ok";
                    var eleproductType = document.getElementById('product_type_id');
                    eleproductType.style.backgroundColor = "#7fc9e5";
                    eleproductType.name = "no";
                    var eleProductDes = document.getElementById('product_des_id');
                    eleProductDes.style.backgroundColor = "#7fc9e5";
                    eleProductDes.name = "no";
                    addTagsToTable(1);
                }

                function  excuteProductType() {
                    var eleoccasion = document.getElementById('occasion_id');
                    eleoccasion.style.backgroundColor = "#7fc9e5";
                    eleoccasion.name = "no";
                    var eleproductType = document.getElementById('product_type_id');
                    eleproductType.style.backgroundColor = "#e59b7f";
                    eleproductType.name = "ok";
                    var eleProductDes = document.getElementById('product_des_id');
                    eleProductDes.style.backgroundColor = "#7fc9e5";
                    eleProductDes.name = "no";
                    addTagsToTable(0);
                }
                function excuteProductDescription() {
                    var eleoccasion = document.getElementById('occasion_id');
                    eleoccasion.style.backgroundColor = "#7fc9e5";
                    eleoccasion.name = "no";
                    var eleproductType = document.getElementById('product_type_id');
                    eleproductType.style.backgroundColor = "#7fc9e5";
                    eleproductType.name = "no";
                    var eleProductDes = document.getElementById('product_des_id');
                    eleProductDes.style.backgroundColor = "#e59b7f";
                    eleProductDes.name = "ok";
                    addTagsToTable(2);
                }
                function rowClick(vl) {

                    var color = '#ffffff'
                    try {
                        color = rgb2hex(vl.style.backgroundColor);
                    } catch (e) {

                    }


                    if (color === '#e59b7f') {
                        vl.style.backgroundColor = "#ffffff";
                        vl.id = "nottoadd"
                    } else {
                        vl.style.backgroundColor = "#e59b7f";
                        vl.id = "toadd"
                    }
                }
                var hexDigits = new Array
                        ("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f");
                //Function to convert hex format to a rgb color
                function rgb2hex(rgb) {
                    rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                    return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
                }

                function hex(x) {
                    return isNaN(x) ? "00" : hexDigits[(x - x % 16) / 16] + hexDigits[x % 16];
                }
        </script>
        <script type="text/javascript">
            //auto expand textarea
            function adjust_textarea(h) {
                h.style.height = "20px";
                h.style.height = (h.scrollHeight) + "px";
            }
        </script>

    <div id="header"><h3>Vue 2.0 Product Curation - Curate Product</h3></div>

    <div id="instructions">
        <p><br>Please ensure that the data is accurate and make necessary corrections.</br>

            <br>Tag the product appropriately and submit the finished product</br>
        </p>

    </div>



</head>
<body onblur="window.focus()" onload="prettyPrint();" >

    <input type="button" class="myButtonRED" value="Archive"  onClick="archieveProduct()" id ="archive_but_id_start" style="float: right;" width="200" height="200"/>
    <form action="" method="post" class="form-style-7">

        <ul>
            <p  id="title_node_id"></p>
            <li>
                <label for="id_title">Product Title or Name</label>
                <input id="id_title" type="text" name="id_title">
                <span>Review the title for completeness; ensure that there are no junk characters. Copy-Paste from the original website to fix errors.</span>
            </li>
            <p  id="description_node_id"></p>
            <li>
                <label for="id_description">Product Description</label>
                <textarea id="id_description" name="id_description" placeholder="Copy Past Descriptio Here" style="width: 640px; height: 150px;" rows="5" cols="200">
                </textarea>
                <span>Review description for completeness and any mixed up words. Copy-Paste all relevant text from Product Description.</span>
            </li>

            <li>
                <label for="id_gender">Add Gender Tag</label>
                <br>
                <input type="radio" name="gender" value="Women" id="r2" checked="checked">Women
                <input type="radio" name="gender" value="Men" id="r1">Men
                <input type="radio" name="gender" value="Unisex" id="r3">Unisex
                <input type="radio" name="gender" value="Boys" id="r4">Boys
                <input type="radio" name="gender" value="Girls" id="r5">Girls<br>
                <input type="button" class="button" value="Add Gender Tag" onclick="createGenderTag()"  />
                <span>Select One and Create Gender Tag</span>
            </li>




            <li>
                <label>Create Tags</label>
                <br>
                <!--                <table class="altrowstable" id="alternatecolor"  width="600">
                
                                    <tr>
                                        <th><strong>Product Type:</strong>
                                    <div style="padding:20px">
                                        <select id="select_tagCategory" name="selection" multiple="multiple"  style="width: 150px">
                
                                        </select>
                                        </th>
                
                                        <th><strong>Occasion:</strong>
                                        <div style="padding:20px">
                                            <select id="select_tagString" name="selection"  multiple="multiple"  style="width: 150px" data-native-menu="false">
                
                                            </select>
                                        </div>
                
                                        </th>
                
                                        <th><strong>Product Description:</strong>
                                        <div style="padding:20px">
                                            <select id="select_tagSubCategory" name="selection" multiple="multiple"   style="width: 150px" data-native-menu="false">
                
                
                                            </select>
                                        </div>
                
                                        </th>
                
                                        </tr>
                
                                </table>-->

                <div id="navcontainer" >
                    <ul id="navlist">
                        <li  style="background-color: #7fc9e5"><a onclick="excuteProductType()" id="product_type_id">Product Type</a></li>
                        <li  style="background-color: #7fc9e5"><a onclick="excuteOccasion()" id="occasion_id" >Occasion</a></li>
                        <li  style="background-color: #7fc9e5"><a onclick="excuteProductDescription()" id="product_des_id" >Product description</a></li>

                    </ul>
                </div>
                <div class="datagrid"  ><table id="tablewithtags_id" border="1">

                    </table></div>

                <input type="button" class="button" value="Tag to product" onclick="addTagsToTableVaz()" />

            </li>
            <li> <label>Create Custom Tag</label>
                <br>
                <table    class="altrowstable" id="create_custom_tag"   width="600">
                    <tr>

                        <td>
                            <div>
                                Tag Category <br><br>
                                <input id="id_tag_cat" type="text" width="200" name="name"  placeholder="Enter Tag Category" style="border:1px solid #6B9FFF"/>

                            </div>

                        </td>
                        <td>
                            <div>
                                Tag String <br><br>
                                <input id="id_tag_str" type="text" width="200" name="name" autocomplete="off"   placeholder="Enter Tag String" style="border:1px solid #6B9FFF"/>

                            </div>

                        </td>
                        <td boarder ="1">
                            <div>
                                Tag Sub Category <br> <br>
                                <input  type="text" width="200"  name="name" autocomplete="off"  placeholder="Enter Tag SubCat" id="id_sub_str" style="border:1px solid #6B9FFF"/>

                            </div>

                        </td> 
                    </tr>


                </table>
                <input type="button" class="button" value="Create&Attach Custom Tag" onclick="createCustomTag()"  /> 
                <span>Enter new tags with out typing mistakes</span>
            </li>


            <li>
                <label>Product Tags</label>
                <br>
                <table class="altrowstable" id="created_tags_table" width="600">
                    <tr>
                        <th>Tag Category</th>
                        <th>Tag String</th>
                        <th>Tag Sub Category</th>
                        <th>Delete Tag?</th>
                    </tr>
                </table>
                <br>
                <span>Tags show up here as you create them; you may correct errors by clicking on Untag</span>


            </li>



            <li>
                <label for="id_productstate">Current Product State</label>
                <br>
                <div id="single_select_1"></div><br>
                <span>Set Product State (Advanced Users only)</span>

            </li>
            <p  id="provider_node_id"></p>
            <li>
                <label>Provider Info</label>
                <table boarder = "1">
                    <tr>
                        <td> <div>Currency <br> <input type="text" width="200" placeholder="Enter Currency" id="currency_id" style="border:1px solid #6B9FFF"/></div></td>
                        <td boarder ="1"> <div>Price <br> <input type="text" width="200" placeholder="Enter Price" id="price_id" style="border:1px solid #6B9FFF"/></div></td>
                        <td boarder ="1"> <div>Store <br> <input type="text" width="200" placeholder="Enter Store" id="store_id" style="border:1px solid #6B9FFF"/></div></td>
                    </tr>
                    <tr>

                        <td> <div>Sale Price <br> <input type="text" width="200" id="sale_price_id" style="border:1px solid #6B9FFF"/></div></td>
                        <td boarder ="1"> <div>Sale Expiry Date <br> <input type="text" width="200" id="expiry_date_id" style="border:1px solid #6B9FFF"/></div></td>
                        <td><div>OnSale<br><input type="checkbox" id="onSale_selection_id" onclick='handleOnSAleClick(this);'>  </div></td>
                    </tr>
                    <tr>
                        <td style="border:1px solid #6B9FFF"><div> Availability <br>
                                <div align="left"><br>
                                    <input type="radio" id="availability_id" name="group1"   value="IN_STOCK" checked="true"> IN_STOCK<br>
                                    <input type="radio" id="availability_id" name="group1"  value="OUT_OF_STOCK"> OUT_OF_STOCK<br>
                                    <input type="radio" id="availability_id" name="group1"  value="RUNNING_LOW"> RUNNING_LOW<br>
                                    <input type="radio" id="availability_id" name="group1"   value="EXCESS_INVENTORY"> EXCESS_INVENTORY<br>
                                    <input type="radio" id="availability_id" name="group1"   value="TEMPORARY_UNAVAILABLE"> TEMPORARY_UNAVAILABLE<br>
                                    <input type="radio" id="availability_id" name="group1"   value="PERMANENTLY_UNAVAILABLE"> PERMANENTLY_UNAVAILABLE<br>

                                </div>

                            </div></td>
                    </tr>
                </table>
                <span>Must fill  provider info</span>
            </li>
            <p  id="color_node_id"></p>
            <li>
                <label>Colors</label>
                <table class="altrowstable"  ><tr><td align="center"    width="600"><input type="text" name="name" autocomplete="off"  placeholder="Enter Color" id="color_id"></td></tr></table>

                <span>Enter comma separated Colors</span>

            </li>
            <p  id="size_node_id"></p>
            <li>
                <label>Sizes</label>
                <table id="selecting_size_table"> 


                    <tr> <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">S</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">M</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">L</td>
                        <td id="unselectedsize" bgcolor="#bcd7e5" align="center" width="40px" height="40px" onclick="clickedValuey(this)">XL</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">No size</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">One size</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">XS</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">XXXL</td>



                    </tr>
                    <tr> <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)"> 1</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)"> 2</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">3</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">4</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">5</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">6</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">7</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">8</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">9</td></tr>
                    <tr> <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">10</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">11</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">12</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">13</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">14</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">15</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">16</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">17</td></tr>
                    <tr><td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">18</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">19</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">20</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">21</td>

                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">32</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">34</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">35</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">36</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">37</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">38</td>
                        <td id="unselectedsize" align="center" bgcolor="#bcd7e5" width="40px" height="40px" onclick="clickedValuey(this)">40</td>



                    </tr>

                </table>
                <table class="altrowstable"  ><tr><td align="center"    width="600"><input type="text" name="name" autocomplete="off"  placeholder="Select or enter sizes" id="size_id"></td></tr></table>
                <span>Select Size or Enter</span>
            </li>   
            <input type="button" class="button" value="Curate and Finish" onClick="updateProvider()" id ="send_but_id"/>

            <input type="button" class="button" value="Archive" onClick="archieveProduct()" id ="archive_but_id"/>


            </li>

        </ul>



    </form>
    <script>
function clickedValuey(v){
    
}

        function  getSelectedOnes() {

            var elements = [];
            $("td[id^='selectedsizes']").each(function() {
                var val = this.textContent;
                this.style.backgroundColor = "#e5cabc"
                elements.push(val);


            });
            $("td[id^='unselectedsize']").each(function() {

                this.style.backgroundColor = "#bcd7e5"



            });
            var stringOfTagss = elements.toString();
            document.getElementById("size_id").value = stringOfTagss;
        }

        function clickedValue(val) {
            var idval = val.id;


            if (idval === 'unselectedsize') {
                val.id = "selectedsizes";
            }
            else {
                val.id = "unselectedsize";
            }

            getSelectedOnes();
//            var strings = [];
//
//            strings = document.getElementById("size_id").value.split(",");
//
//            for (var j = 0; j < strings.length; j++) {
//                if (val.trim() === strings[j].trim()) {
//                    alert("Duplicate Size");
//                    return;
//                }
//            }
//
//            if (strings.length === 1) {
//                if (strings[0].length === 0) {
//                    document.getElementById("size_id").value = val;
//                } else {
//                    document.getElementById("size_id").value = document.getElementById("size_id").value + ", " + val;
//                }
//            } else {
//                document.getElementById("size_id").value = document.getElementById("size_id").value + ", " + val;
//            }

        }
    </script>
    <form action="" method="post" class="smart-green">

        <di id="single_select_1" ></di>

    </select>



    <div id="image_table_id"></div>



    <script type="text/javascript">

        $(function() {
            var availableTags = [
                "Product Type",
                "Occasion",
                "Product description",
            ];
            $("#id_tag_cat").autocomplete({
                source: availableTags,
                minLength: 0,
            }).focus(function() {
                //Use the below line instead of triggering keydown
                $(this).autocomplete('search');
            });
        });
//        $(function() {
//            $('table').on('click', 'td', function() {
//                // $(this).parent().children().removeClass('active');
//                $(this).addClass('active');
//            });
//        });


    </script>

</label>



</form> 


</body>


</html>
